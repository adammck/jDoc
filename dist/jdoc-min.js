(function(){var d=this.jDoc=function(a){if(arguments.length===2){var b=arguments[1];this._list=arguments[0];this._index=b}else{this._list=a!==null?[a]:[];this._index=0}},i=new d(null),j=function(a,b){if(typeof b==="object"&&typeof b.length==="number")for(var c=0;c<b.length;++c)a.push(b[c]);else a.push(b)},h=function(a,b,c,e){a.each(function(g){g=g.json();for(var k in g){var f=g[k];if(typeof f!=="function"){b(k)&&j(e,f);if(c)if(typeof f==="object")typeof f.length==="number"?h(new d(f,0),b,c,e):h(new d(f),
b,c,e)}}})},l=function(a){return typeof a==="function"?a:a instanceof RegExp?function(b){return a.test(b)}:function(b){return b===a}};$.extend(d.prototype,{any:function(){return this._list.length>0},first:function(){return new d(this._list,0)},next:function(){if(!this.hasValue())return this;var a=this._index+1;if(a<this._list.length)return new d(this._list,a);return i},each:function(a,b){for(var c=0,e=this._list[0];typeof e!=="undefined"&&a.call(b,new d(e))!==false;e=this._list[++c]);},count:function(){return this._list.length},
get:function(a){if(a>=0&&a<this._list.length)return new d([this._list[a]],0);return i},where:function(a,b){var c=[];this.each(function(e){a.call(b,e)&&j(c,e.json())});return new d(c,0)},union:function(a){if(!this.any())return a;if(!a.any())return this;return new d(this._list.concat(a._list),0)},select:function(a,b){var c=[];this.each(function(e){c.push(a.call(b,e))});return c},$:function(a){a=a.split("/");for(var b=0;b<a.length;++b);},hasValue:function(){return this._index<this._list.length},json:function(){if(!this.hasValue())throw new Exception("jDoc has no value");
return this._list[this._index]},text:function(){for(var a=this.json();a!==null;)switch(typeof a){case "boolean":case "number":return a.toString();case "string":return a;case "object":if(typeof a.length==="undefined"){a=a["#text"];return typeof a!=="undefined"?a:null}else if(a.length>0)a=a[0];else return null;break;default:return null}return null},match:function(a){if(!this.hasValue())return this;var b=[];h(this,l(a),false,b);return new d(b,0)},deepMatch:function(a){if(!this.hasValue())return this;
var b=[];h(this,l(a),true,b);return new d(b,0)},attributes:function(){return this.match(/^@.+$/)},elements:function(){return this.match(/^[^@#].*$/)}})})();
