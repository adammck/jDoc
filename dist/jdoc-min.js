(function(){var c=function(a){if(arguments.length===2){if(!(this instanceof c))return new c(arguments[0],arguments[1]);var b=arguments[1];this._list=arguments[0];this._index=b}else{if(!(this instanceof c))return new c(a);this._list=a!==null?[a]:[];this._index=0}};c.VERSION="0.2.0";if(typeof module!=="undefined"&&module.exports)module.exports=c;else this.jDoc=c;var j=new c(null),k=function(a,b){var d;if(typeof b==="object"&&typeof b.length==="number")for(d=0;d<b.length;++d)a.push(b[d]);else a.push(b)},
i=function(a,b,d,e){a.each(function(g){g=g.value();for(var h in g){var f=g[h];if(typeof f!=="function"){b(h)&&k(e,f);if(d)if(typeof f==="object")typeof f.length==="number"?i(new c(f,0),b,d,e):i(new c(f),b,d,e)}}})},m=function(a){return typeof a==="function"?a:a instanceof RegExp?function(b){return a.test(b)}:function(b){return b===a}},l={};c.prototype.any=function(){return this._list.length>0};c.prototype.first=function(){return new c(this._list,0)};c.prototype.next=function(){if(!this.exists())return this;
var a=this._index+1;if(a<this._list.length)return new c(this._list,a);return j};c.prototype.each=function(a,b){var d,e;d=0;for(e=this._list[0];typeof e!=="undefined"&&a.call(b,new c(e))!==false;e=this._list[++d]);};c.prototype.count=function(){return this._list.length};c.prototype.get=function(a){if(a>=0&&a<this._list.length)return new c([this._list[a]],0);return j};c.prototype.where=function(a,b){var d=[];this.each(function(e){a.call(b,e)&&k(d,e.value())});return new c(d,0)};c.prototype.union=function(a){if(!this.any())return a;
if(!a.any())return this;return new c(this._list.concat(a._list),0)};c.prototype.map=function(a,b){var d=[];this.each(function(e){d.push(a.call(b,e))});return d};c.prototype.exists=c.prototype.hasValue=function(a){var b=this;if(typeof a==="string")b=this.select(a);return b._index<b._list.length};c.prototype.value=function(a){var b=this;if(typeof a==="string")b=this.select(a);if(!b.exists())return null;return b._list[this._index]};c.prototype.text=function(a){for(a=this.value(a);a!==null;)switch(typeof a){case "boolean":case "number":return a.toString();
case "string":return a;case "object":if(typeof a.length==="undefined"){a=a["#text"];return typeof a!=="undefined"?a:null}else if(a.length>0)a=a[0];else return null;break;default:return null}return null};c.prototype.match=function(a,b){if(!this.exists())return this;var d=[];i(this,m(a),b||false,d);return new c(d,0)};c.prototype.attributes=function(){return this.match(/^@.+$/)};c.prototype.elements=function(){return this.match(/^[^@#].*$/)};c.prototype.select=function(a){var b;if(typeof(b=l[a])==="undefined"){b=
Function;if(typeof a!=="string"||a==="")throw Error("invalid selector");var d=a.split("/"),e=false,g="this",h;for(h=0;h<d.length;++h){var f=d[h];switch(f){case "":if(h===0)continue;if(e)throw Error("invalid selector");e=true;continue;case ".":break;case "..":throw Error("unsupported .. operation in selector");case "*":g+=e?".match(/^[^@#].*$/, true)":".match(/^[^@#].*$/)";break;case "@*":g+=e?".match(/^@.+$/, true)":".match(/^@.+$/)";break;default:g+=e?'.match("'+f.replace('"','\\"')+'", true)':'.match("'+
f.replace('"','\\"')+'")'}e=false}if(e)throw Error("invalid selector");l[a]=b=new b("return "+g)}return b.call(this)}})();
